# 面试题目
```
1. 代理服务器的原理是什么？
```
代理服务器顾名思义，他的作用就是代替你去做一些事情，比如抓取网页。比较知名的`GoAgent`和`shadowsocks`都是代理软件，都有客户端以及服务器端。

其中`GoAgent`的原理是在本地搭一个HTTP(s)代理服务器，浏览器上做好代理配置，然后本地代理再将浏览器的请求转发到墙外的服务器，再由远程服务器请求数据。
普通的Http代理就是浏览器将请求发给代理服务器，然后代理服务器访问数据，返回给浏览器。整个过程比`GoAgent`要少一个环节。有一个本地代理的好处是可以在本地代理和代理服务器之间进行加密通信，增加信息安全，同时可以在本地代理处增加规则，过滤掉不需要使用代理服务器的链接，加快访问速度。

浏览器对于设置了代理的情况，第一行的`request line`会发生如下的变化：

```
#未设置代理
GET /index.php HTTP/1.1
#设置了代理
GET http://www.domain.com/index.php HTTP/1.1
```

其他的头信息和body部分格式都不会变。第一行变化的原因，是让代理服务器可以读到第一行就就可以确定`remote host`的地址了，然后就可以进行转发了。从而减少计算开支。

# 实现思路

知道了代理服务器的原理，那么我们就知道了如何实现一个代理服务器了。这里我们只是实现一个简单的代理服务器，用来代理我们去获得网页的内容，因为是普通代理，所以我们就不需要一个本地的客户端。

我们实现的代理服务器按照下面的顺序工作：

1. 获取请求数据部分
2. 给`remote host`转发请求
3. 获得`remote host`返回的数据
4. 返回获得数据

## 获取请求数据

代理服务器获取请求数据部分，有两种方式：

1. 使用socket通信，原样转发，这样效率高
2. 使用语言提供的上层API，比如cURL模块提供的curl方法

我们这里选择使用socket通信，实现简单，而且效率高。

## 转发请求

## 获得返回数据

## 返回数据
